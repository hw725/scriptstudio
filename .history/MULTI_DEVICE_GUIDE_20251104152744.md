# 🌍 ScriptStudio 다중 기기 사용 가이드

## 🎯 개요

ScriptStudio는 **하나의 Supabase 계정**으로 여러 기기에서 동시에 사용할 수 있습니다.  
각 기기는 독립적으로 **오프라인/온라인 모드**를 선택할 수 있습니다.

---

## 🖥️ 지원되는 환경

### 데스크톱
- ✅ Windows PC
- ✅ Mac
- ✅ Linux

### 모바일
- ✅ iPhone/iPad (Safari)
- ✅ Android (Chrome)

### 브라우저
- ✅ Chrome
- ✅ Firefox
- ✅ Safari
- ✅ Edge

---

## 🔄 동작 방식

### 기본 원리

```
기기 1 (집 PC)          기기 2 (노트북)        기기 3 (태블릿)
     ↓                       ↓                      ↓
로컬 IndexedDB          로컬 IndexedDB         로컬 IndexedDB
     ↓                       ↓                      ↓
     ↓                       ↓                      ↓
     └────────────→  Supabase  ←────────────────┘
                    (중앙 서버)
```

### 핵심 개념

1. **각 기기는 독립적인 로컬 저장소**를 가집니다
2. **온라인 모드**일 때 Supabase와 동기화
3. **오프라인 모드**일 때 로컬에만 저장
4. **동일한 Supabase 계정**으로 로그인하면 데이터 공유

---

## 📱 시나리오 1: 집 PC + 노트북 (온라인 모드)

### 설정

#### 기기 1: 집 PC
```javascript
// Vercel URL 접속: https://scriptstudio.vercel.app
// 브라우저 콘솔 (F12)
window.__scriptstudio_offline_get()  // false (온라인 모드)
```

#### 기기 2: 노트북
```javascript
// 동일한 Vercel URL 접속
window.__scriptstudio_offline_get()  // false (온라인 모드)
```

### 사용 예시

**집 PC에서:**
1. 새 프로젝트 "논문 작성" 생성
2. 노트 "서론" 작성
3. → 즉시 Supabase에 저장됨

**노트북에서:**
1. 페이지 새로고침 (F5)
2. → "논문 작성" 프로젝트 자동 표시
3. → "서론" 노트 바로 보임
4. 노트 "본론" 추가 작성

**다시 집 PC에서:**
1. 페이지 새로고침
2. → "본론" 노트도 자동 표시 ✅

---

## 🏠 시나리오 2: 집에서만 사용 (오프라인 모드)

### 설정

```javascript
// 모든 기기에서
window.__scriptstudio_offline_set(true)
```

### 특징

✅ **장점:**
- 매우 빠른 응답 속도
- 인터넷 연결 불필요
- 데이터 트래픽 절약

⚠️ **주의:**
- 각 기기의 데이터가 **독립적**
- 기기 간 동기화 안 됨
- 브라우저 데이터 삭제 시 복구 불가능

### 사용 예시

**집 PC:**
- 프로젝트 A 작성
- 로컬 IndexedDB에만 저장

**노트북:**
- 프로젝트 B 작성
- 별도 로컬 저장소

→ **두 기기의 데이터는 별개!**

---

## 🔄 시나리오 3: 혼합 사용 (추천!)

### 설정

**집 PC: 온라인 모드**
```javascript
window.__scriptstudio_offline_set(false)
```

**회사 노트북: 오프라인 모드**
```javascript
window.__scriptstudio_offline_set(true)
```

**태블릿: 온라인 모드**
```javascript
window.__scriptstudio_offline_set(false)
```

### 사용 예시

#### 월요일 - 집 PC (온라인)
```
1. 프로젝트 "주간 보고서" 생성
2. 노트 작성
3. → Supabase 저장
```

#### 월요일 - 회사 노트북 (오프라인)
```
1. 회사 기밀 문서 작성
2. → 로컬에만 저장 (안전!)
3. 인터넷 연결 없이 빠르게 작업
```

#### 화요일 - 태블릿 (온라인)
```
1. 페이지 열기
2. → "주간 보고서" 자동 표시 ✅
3. → "회사 기밀 문서" 없음 (노트북에만 있음)
4. 외출 중에도 수정 가능
```

#### 수요일 - 집 PC (온라인)
```
1. 태블릿에서 수정한 내용 자동 동기화 ✅
```

---

## 🚀 실전 워크플로우

### 패턴 1: 메인 기기 + 보조 기기

**메인 기기 (집 PC): 온라인 모드**
- 모든 프로젝트 관리
- Supabase 동기화
- 백업 자동

**보조 기기 (태블릿): 온라인 모드**
- 외출 시 확인/수정
- 동일한 데이터 접근

### 패턴 2: 공개 + 비공개 분리

**기기 1: 온라인 모드**
- 공유해도 되는 문서
- 팀 프로젝트
- 연구 노트

**기기 2: 오프라인 모드**
- 개인 일기
- 기밀 문서
- 로컬에만 보관

### 패턴 3: 백업 전략

**집 PC: 온라인 모드**
- 주요 작업
- Supabase 자동 백업

**노트북: 오프라인 모드**
- 로컬 백업 용도
- 정기적으로 온라인 전환 → 동기화

---

## 🔧 기기별 설정 방법

### 기기 추가하기

#### 1단계: URL 접속
```
https://scriptstudio.vercel.app
```

#### 2단계: 모드 선택

**온라인 모드 (기본값):**
```javascript
// 자동으로 온라인 모드
// 변경 불필요
```

**오프라인 모드로 전환:**
```javascript
// 브라우저 콘솔 (F12)
window.__scriptstudio_offline_set(true)
```

#### 3단계: 확인

```javascript
// 현재 모드 확인
window.__scriptstudio_offline_get()

// 결과
// true  → 오프라인 모드
// false → 온라인 모드
```

---

## 📊 데이터 동기화 이해하기

### 온라인 모드 동기화

```
[기기 1] 노트 작성
    ↓ (즉시)
로컬 IndexedDB 저장
    ↓ (1-2초)
Supabase 업로드
    ↓ (실시간)
[기기 2] 페이지 새로고침
    ↓
Supabase에서 가져오기
    ↓
로컬 캐시에 저장
    ↓
화면에 표시 ✅
```

### 충돌 방지

ScriptStudio는 **Last-Write-Wins** 전략을 사용합니다:

```
기기 1: 노트 "제목 A" → 저장 (10:00)
기기 2: 동일 노트 "제목 B" → 저장 (10:01)

결과: "제목 B"가 최종 버전 ✅
```

**주의:** 동시 편집 시 나중에 저장한 내용이 우선합니다!

---

## 🔄 동기화 시나리오

### 시나리오 A: 실시간 동기화

**조건:** 두 기기 모두 온라인 모드

```
기기 1: 노트 작성 → Supabase 저장
        ↓ (실시간)
기기 2: 페이지 새로고침 → 노트 표시
```

**소요 시간:** 1-3초

### 시나리오 B: 오프라인 → 온라인 전환

**조건:** 오프라인에서 작업 후 온라인 전환

```
기기 1 (오프라인): 노트 5개 작성 → 로컬 저장
        ↓
온라인 모드 전환
        ↓
동기화 큐 처리 (5개 업로드)
        ↓ (10-20초)
Supabase에 모두 저장 ✅
```

### 시나리오 C: 오프라인 유지

**조건:** 계속 오프라인 모드

```
기기 1 (오프라인): 노트 작성 → 로컬 저장
        ↓
기기 2 (온라인): 페이지 새로고침
        ↓
노트 안 보임 (정상)
```

---

## ⚠️ 주의사항

### 1. 브라우저 데이터 삭제

**오프라인 모드:**
```
브라우저 데이터 삭제 → 모든 노트 삭제! 
❌ 복구 불가능!
```

**온라인 모드:**
```
브라우저 데이터 삭제 → 로컬 캐시만 삭제
Supabase에 데이터 있음 ✅
페이지 새로고침 → 자동 복원
```

### 2. 시크릿 모드 / 사생활 보호 모드

```
시크릿 모드 → 세션 종료 시 데이터 삭제
→ 오프라인 모드 사용 시 주의!
→ 온라인 모드 추천
```

### 3. 다른 브라우저

```
Chrome → 로컬 저장소
Firefox → 별도 로컬 저장소
Safari → 별도 로컬 저장소

→ 각 브라우저는 독립적!
→ 온라인 모드 사용 시 Supabase로 공유 가능
```

---

## 🛠️ 문제 해결

### Q1: 다른 기기에서 노트가 안 보여요

**원인:** 오프라인 모드 사용 중

**해결:**
```javascript
// 브라우저 콘솔
window.__scriptstudio_offline_set(false)  // 온라인 전환
// 페이지 새로고침
```

### Q2: 동기화가 느려요

**원인:** 동기화 큐에 많은 작업 대기 중

**확인:**
```javascript
// 브라우저 콘솔
const { localDB } = await import('./src/db/localDB.js')
const queue = await localDB.getSyncQueue()
console.log('대기 중:', queue.length)
```

**해결:**
- 잠시 대기 (자동 처리됨)
- 또는 수동 동기화:
```javascript
const { syncManager } = await import('./src/sync/syncManager.js')
await syncManager.sync()
```

### Q3: 기기마다 다른 데이터가 보여요

**원인:** 일부 기기가 오프라인 모드

**확인:**
```javascript
// 각 기기에서
window.__scriptstudio_offline_get()
```

**해결:**
- 모든 기기를 온라인 모드로 전환
- 페이지 새로고침

---

## 📈 성능 최적화

### 기기별 권장 설정

**집 PC (메인):**
- ✅ 온라인 모드
- 빠른 인터넷 연결
- 자동 백업

**노트북 (이동):**
- ✅ 온라인 모드 (WiFi 있을 때)
- ✅ 오프라인 모드 (카페, 비행기)
- 유연한 전환

**태블릿/스마트폰:**
- ✅ 온라인 모드
- 모바일 데이터 사용
- 간단한 확인/수정

---

## 🎓 고급 사용법

### 1. 선택적 동기화

```javascript
// 특정 프로젝트만 온라인 동기화
// (구현 예정)
```

### 2. 자동 백업

```javascript
// 일정 시간마다 자동 동기화
// (syncManager가 자동 처리)
```

### 3. 충돌 해결

```javascript
// 버전 관리로 충돌 복구
// (VersionHistory 패널 사용)
```

---

## ✅ 체크리스트

### 새 기기 추가 시
- [ ] Vercel URL 접속
- [ ] 모드 선택 (온라인/오프라인)
- [ ] 테스트 노트 작성
- [ ] 다른 기기에서 확인

### 정기 점검
- [ ] 모든 기기의 모드 확인
- [ ] Supabase 저장 공간 확인
- [ ] 동기화 큐 비었는지 확인

---

## 🎉 요약

### 다중 기기 사용 핵심 정리

✅ **기기 추가**: URL 접속만으로 즉시 사용  
✅ **독립적 모드**: 각 기기마다 오프라인/온라인 선택  
✅ **실시간 동기화**: 온라인 모드 시 자동 공유  
✅ **안전한 백업**: Supabase에 자동 저장  
✅ **유연한 전환**: 언제든지 모드 변경 가능  

**이제 어디서든 ScriptStudio를 사용하세요! 🚀**

---

**작성일**: 2025년 11월 4일  
**작성자**: GitHub Copilot  
**버전**: 1.0
